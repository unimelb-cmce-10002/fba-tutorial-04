<!-- question-type: inclass -->
### Exercise 5: Unpacking the Profit Margin-Asset Turnover Scatterplot

In exercise 2, we created the following plot:

```{r}
#| fig-width: 8
#| fig-height: 6
#| fig-align: "center"
#| echo: false
#| warning: false

# To improve our visualization, we need to focus on representative 
# firms and drop outliers (see exercises 1 & 4 for more)
firm_strategy |>
    filter(profit_margin > -2) |> 
    ggplot() + 
    geom_point(aes(y = profit_margin, x = asset_turnover), 
                   alpha = 0.3
               ) + 
    # Add a vertical line to show median value
    geom_vline(xintercept = median(firm_strategy$asset_turnover, na.rm = TRUE), 
               linetype = "dashed", color = "blue", size = 1
               ) + 
    # Add a horizontal line to show median value
    geom_hline(yintercept = median(firm_strategy$profit_margin, na.rm = TRUE), 
               linetype = "dashed", color = "blue", size = 1
               ) +  
    theme_minimal() + 
    labs(title = "Variation in Firm Strategy Across A Sample of Large ASX Companies in 2024", 
             x = "Asset Turnover", 
             y = "Profit Margin"
         ) + 
    guides(color = guide_legend(title = NULL))
```

**(a).** Refer to the above plot. Firms that employ a 'high margin' strategy are located in which quadrant? Firms that employ which strategy are located in the bottom-right quadrant?

**(b).** One way to ‘check’ your answers to the above question is to use color to identify each firm’s strategy type. Use the starter code below and explain what the plot reveals.

```{r, eval=FALSE}
YOUR_DATAFRAME |> 
    YOUR_FUNCTION_NAME(profit_margin > -2) |> 
    YOUR_FUNCTION_NAME() + 
    YOUR_FUNCTION_NAME(aes(x = YOUR_VARIABLE_NAME, y = YOUR_VARIABLE_NAME, 
                           fill = YOUR_VARIABLE_NAME
                           ), 
                       alpha = 0.7, shape = 21, size = 3, color = "black"
                      ) + 
    geom_vline(xintercept = median(YOUR_DATAFRAME$YOUR_VARIABLE_NAME, na.rm = TRUE), 
               linetype = "dashed", color = "blue", size = 1
               ) + 
    geom_hline(yintercept = median(YOUR_DATAFRAME$YOUR_VARIABLE_NAME, na.rm = TRUE), 
               linetype = "dashed", color = "blue", size = 1
               ) + 
    scale_fill_okabe_ito() +
    theme_minimal() + 
    labs(title = "Variation in Firm Strategy Across A Sample of Large ASX Companies in 2024", 
             x = YOUR_LABEL, 
             y = YOUR_LABEL
         ) + 
    guides(color = guide_legend(title = NULL), 
           fill = guide_legend(title = YOUR_LABEL))
```

**(c).** Run the first block of code provided below. Which firm from the plot above does this code identify? Run the second block of code provided below. And, which firm from the plot above does this code identify?

```{r, eval=FALSE}
firm_strategy |> 
    filter(strategy_type == 'High volume') |>
    arrange(profit_margin) |>
    select(conml, industry, ebit, at, sale, profit_margin, asset_turnover, roic) |>
    head(1)
```

```{r, eval=FALSE}
firm_strategy |> 
      filter(strategy_type == 'High margin') |>
      arrange(asset_turnover) |>
      select(conml, industry, ebit, at, sale, profit_margin, asset_turnover, roic) |>
      head(1)
```

**(d).** The plots above show that some strategy types are more common than others among our sample of large ASX companies in 2024. Use the starter code below that provides the count of observations for each strategy type in our sample. Which strategy type is more common, high margin or high volume?

```{r, eval=FALSE}
YOUR_DATAFRAME |>
    YOUR_FUNCTION_NAME(profit_margin > -2) |>
    group_by(YOUR_VARIABLE_NAME) |>
    YOUR_FUNCTION_NAME(obs = n())
```

**(e).** Let’s dig down into one of these firm strategy types, High margin. Write and run a chunk of code that counts the number of firms from each industry that employ a high-margin strategy. Write your code such that it outputs a table that shows the five industries with the highest counts. Which industry accounts for the most high-margin firms in our sample?

```{r, eval=FALSE}
WRITE YOUR ANSWER HERE
```

**(f).** Now, write and run a chunk of code that produces the equivalent table but for firms that employ a high-volume strategy. Compare this table to the one you produced in the previous question.

```{r, eval=FALSE}
WRITE YOUR ANSWER HERE
```

**(g).** In the lecture, we examined firms from the ASX’s ‘big industries’ (i.e., the seven industries that account from more than half of all large listed firms in Australia). Let’s gain some insight into how strategy type varies within each of these big industries. Use the starter code below to produce a stacked bar plot that shows the share of each industry’s firms that employ a given strategy type. What are the main insights that this plot reveals? Which industries have the most variation in strategy type? The least?

```{r, eval=FALSE}
YOUR_DATAFRAME |>  
    # Use %in% for filtering industries
    YOUR_FUNCTION(profit_margin > -2 & industry %in% big_industries) |>
    # Group by both industry and strategy_type
    group_by(YOUR_VARIABLE_NAME, YOUR_VARIABLE_NAME) |>  
    # Count the number of occurrences for each strategy_type within each industry
    YOUR_FUNCTION_NAME(count = n(), .groups = 'drop') |>  
    # Map 'industry' to x-axis and 'strategy_type' to fill
    ggplot(aes(x = YOUR_VARIABLE_NAME, y = YOUR_VARIABLE_NAME, fill = YOUR_VARIABLE_NAME)) +  
    geom_bar(stat = "identity") +
    theme_minimal() +  
    # Rotate and align x-axis labels
    theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),  
          # Remove the legend title
          legend.title = element_blank()
          ) +
    # Wrap x-axis labels at width 10 characters
    scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +  
    # Use color palette for filling
    scale_fill_okabe_ito() +  
    labs(#No label for x-axis
         x = NULL,
         y = "No. of Firms",
         title = "Strategy Type Across Large Australia Comapnies in 2024: The 'Big' Industries"
         )  
```

Your plot should look like this:

```{r, echo=FALSE, warning=FALSE}
firm_strategy |>  
    # Use %in% for filtering industries
    filter(profit_margin > -2 & industry %in% big_industries) |> 
    # Group by both industry and strategy_type
    group_by(industry, strategy_type) |>  
    # Count the number of occurrences for each strategy_type within each industry
    summarize(count = n(), .groups = 'drop') |>  
    # Map 'industry' to x-axis and 'strategy_type' to fill
    ggplot(aes(x = industry, y = count, fill = strategy_type)) +  
    geom_bar(stat = "identity") +  
    theme_minimal() +  
    # Rotate and align x-axis labels
    theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),  
          # Remove the legend title
          legend.title = element_blank()
          ) +  
    # Wrap x-axis labels at width 10 characters
    scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +  
    scale_fill_okabe_ito() +
    labs(#No label for x-axis
         x = NULL,
         y = "No. of Firms",
         title = "Strategy Type Across Large Australia Comapnies in 2024: The 'Big' Industries"
         ) 
```

<!-- BEGIN PROFILE:r-teaching-guide -->
::: {.content-visible when-profile="r-teaching-guide"}

::: {.teaching-block}

::: {.teaching-block-header}
Teaching Note
:::

::: {.teaching-block-body}

🎯 **Learning Objective** 

Students should:

- Verify classifications visually using `ggplot2` scatterplots with medians as cut-offs.
- Identify extreme performers via `filter()` and `arrange()`.
- Summarise and compare strategy counts across industries with `group_by()` and `summarize()`.

✅   **Core Concepts to Highlight**

- Plots validate classification and make patterns visible.
- Industry representation can reflect both strategic tendencies and data set composition.
- Some industries show diverse strategies; others are concentrated in one type.

💬 **Suggested In-Class Prompts** (if needed)

“Why use medians instead of means for quadrant boundaries?”

“What would you change in the pipeline to find the three highest-margin firms?”

“Why might Metals & Mining appear in both high-margin and high-volume categories?”

📌 **Common Misunderstandings**

- Confusing high volume with high total sales instead of high asset turnover.
- Assuming quadrant assignment is fixed over time.
- Overlooking industry size effects when interpreting strategy counts.

:::

:::

:::
<!-- END PROFILE:r-teaching-guide -->

<!-- BEGIN PROFILE:r-solutions -->
::: {.content-visible when-profile="r-solutions" when-profile="r-teaching-guide"}

::: {.solution-block}

::: {.solution-block-header}
Solution
:::

::: {.solution-block-body}

**(a). Using quadrants to identify firm strategy type** 

High-margin firms are in the top-left quadrant, while high-volume firms are in the bottom-right quadrant.

**(b). Using `fill =` to verify firm strategy types** 

Here's the updated code:

```{r}
firm_strategy |> 
  filter(profit_margin > -2) |> 
  ggplot() + 
    geom_point(aes(x = asset_turnover, y = profit_margin, fill = strategy_type), 
               alpha = 0.7, shape = 21, size = 3, color = "black"
               ) + 
    geom_vline(xintercept = median(firm_strategy$asset_turnover, na.rm = TRUE), 
                   linetype = "dashed", color = "blue", size = 1
               ) + 
    geom_hline(yintercept = median(firm_strategy$profit_margin, na.rm = TRUE), 
                   linetype = "dashed", color = "blue", size = 1
               ) + 
    scale_fill_okabe_ito() +
    theme_minimal() + 
    labs(title = "Variation in Firm Strategy Across A Sample of Large ASX Companies in 2024", 
         x = "Asset Turnover", 
         y = "Profit Margin"
        ) + 
    guides(color = guide_legend(title = NULL), 
              fill = guide_legend(title = "Strategy Type"))
```

The color coding helps to visually distinguish between the different strategy types. The plot confirms that high-margin firms are in the top-left quadrant, while high-volume firms are in the bottom-right quadrant. The plot shows that Sinking Ships are in the bottom-left quadrant, and Superstars are in the top-right quadrant.

**(c). Filtering to find observations from plots** 

The high-volume strategy firm (Star Entertainment) that has the lowest profit margin-i.e., the 'southern-most' high-volume firm in the plot above:

```{r}
firm_strategy |> 
    filter(strategy_type == 'High volume') |>
    arrange(profit_margin) |>
    select(conml, industry, ebit, at, sale, profit_margin, asset_turnover, roic) |>
    head(1)
```

The high-margin firm (Jupiter Mines) that has the lowest volume:

```{r}
firm_strategy |> 
    filter(strategy_type == 'High margin') |>
    arrange(asset_turnover) |>
    select(conml, industry, ebit, at, sale, profit_margin, asset_turnover, roic) |>
    head(1)
```

**(d). Strategy types that are most common and least common in our sample** 

Here's the updated code:

```{r}
firm_strategy |>
    filter(profit_margin > -2) |>
    group_by(strategy_type) |>
    summarize(obs = n())
```

The most common strategy type in our (trimmed) sample is 'High volume', with 60 firms. The least common type is 'Sinking ship', with 31 firms. Poor-performing firms—especially those in the Sinking ship quadrant—are the most likely to face financial distress or exit the market. This fits with the economic logic we discussed: persistent low margins and asset turnover erode returns and make it hard to compete. Over time, these firms either adapt their strategy (shift quadrants) or disappear from the data set.

**(e). Industries that account for the most high-margin firms** 

Here's the updated code:

```{r}
firm_strategy |>
    filter(profit_margin > -2 & strategy_type == 'High margin') |>
    group_by(industry) |>
    summarize(obs = n()) |>
    arrange(desc(obs)) |>
    head(5)
```

In our trimmed sample, of firms that employ a high-margin strategy, Mining & Metals industry accounts for the largest share. This is consistent with our earlier observations in Exercise 3 (a).

**(f). Industries that account for the most high-volume firms** 

Here's the updated code:

```{r}
firm_strategy |>
    filter(profit_margin > -2 & strategy_type == 'High volume') |>
    group_by(industry) |>
    summarize(obs = n()) |>
    arrange(desc(obs)) |>
    head(5)
```

In our trimmed sample, of firms that employ a high-volume strategy, Construction & Engineering, Mining & Metals, and Special Retail industries account for the largest share. These industries likely operate under conditions where competitive pressures and customer expectations keep margins tight. Profitability depends on selling large quantities, spreading fixed costs over high output, and leveraging economies of scale in production, procurement, or distribution. 

Part of why Metals & Mining appears here could also be structural, not just strategic. Mining firms make up a huge share of the ASX by count and by market capitalization, so even if only a fraction of them follow a high-volume, low-margin model, they can still show up prominently in the list.

**(g). Industry composition by strategy type**

Here's the updated code:

```{r}
firm_strategy |>  
    # Use %in% for filtering industries
    filter(profit_margin > -2 & industry %in% big_industries) |> 
    # Group by both industry and strategy_type
    group_by(industry, strategy_type) |>  
    # Count the number of occurrences for each strategy_type within each industry
    summarize(count = n(), .groups = 'drop') |>  
    # Map 'industry' to x-axis and 'strategy_type' to fill
    ggplot(aes(x = industry, y = count, fill = strategy_type)) +  
    geom_bar(stat = "identity") +  
    theme_minimal() +  
    # Rotate and align x-axis labels
    theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),  
          # Remove the legend title
          legend.title = element_blank()) +  
    # Wrap x-axis labels at width 10 characters
    scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +  
    scale_fill_okabe_ito() +
    labs(#No label for x-axis
         x = NULL,
         y = "No. of Firms",
         title = "Strategy Type Across Large Australia Comapnies in 2024: The 'Big' Industries"
         ) 
```

Main insights:

- Metals & Mining dominates — largest number of firms and all four strategy types in substantial numbers, indicating both size and heterogeneity. 
- Specialty Retail has the least variation in strategy types.
- High-volume strategies are widespread — especially in Construction & Engineering, Food Products, and Specialty Retail.  
- Superstars cluster in certain sectors — notably Specialty Retail and Hotels, Restaurants, and Leisure.  
- Sinking ships concentrate in cyclical, capital-intensive sectors — particularly Metals & Mining and Oil, Gas & Consumable Fuels.  

:::

:::

:::
<!-- END PROFILE:r-solutions -->